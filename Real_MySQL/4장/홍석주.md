# 아키텍처

## 4.1 MySQL 엔진 아키텍처

### MySQL 엔진

- 

### 스토리지 엔진

### 쿼리 파서

- 사용자 요청으로 들어온 쿼리 문장을 토큰으로 분리해 트리 형태의 구조로 만들어 내는 작업
- 쿼리 문장의 기본 문법 오류는 이 과정에서 발견되고 사용자에게 오류 메시지 전달

> 토큰: MySQL이 인식할 수 있는 최소 단위의 어휘나 기호

### 전처리기

- 파서 과정에서 만들어진 파서 트리를 기반으로 쿼리 문장에 구조적인 문제점 있는지 확인
- 토큰을 테이블 이름, 칼럼 이름, 또는 내장 함수와 같은 개체를 매핑해 존재 여부, 접근 권한 등을 확인
- 존재하지 않거나 권한상 사용할 수 없는 개체의 토큰은 여기서 걸러짐

### 옵티마이저

- 사용자의 요청으로 들어온 쿼리 문장을 저렴한 비용으로 가장 빠르게 처리할지 결정하는 역할

## 4.2 InnoDB 스토리지 엔진 아키텍처

- MySQL에서 사용할 수 있는 스토리지 엔진 중 거의 유일하게 레코드 기반의 잠금 제공
- 높은 동시성 처리 가능하고 안정적임

### 프라이머리 키에 의한 클러스터링

### 외래 키 지원

- MyISAM이나 MEMORY테이블에선 외래 키를 지원하지 않음

### MVCC(Multi Version Concurrency Control)

- 하나의 레코드에 대해 여러 개의 버전이 동시에 관리됨
- 레코드 레벨의 트랜잭션을 지원하는 DBMS가 제공하는 기능이며, 잠금을 사용하지 않는 일관된 읽기를 제공
- InnoDB는 언두 로그(Undo log)를 이용해서 구현

### 잠금 없는 일관된 읽기(Non-Locking Consistent Read)

- MVCC 기술을 통해 잠금을 걸지 않고 읽기 작업 수행
- 잠금을 걸지 않기 때문에 InnoDB에서 읽기 작업은 다른 트랜잭션이 가지고 있는 잠금을 기다리지 않고, 읽기 작업 가능
- 격리 수준이 SERIALIZABLE이 아닌 레벨들은 다른 트랜잭션 변경 작업과 관계없이 바로 실행 가능하다
- 변경되기 전의 데이터를 읽기 위해선 언두 로그를 사용한다.

> 트랜잭션이 시작됐다면 가능한 한 빨리 롤백이나 커심을 통해 트랜잭션을 완료하라

### 자동 데드락 감지

### 자동화된 장애 복구

### InnoDB 버퍼 풀