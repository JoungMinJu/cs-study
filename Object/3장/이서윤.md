# 3. 역할, 책임, 협력

- 객체지향 패러다임 관점에서의 핵심
    - 협력 : 애플리케이션 기능을 구현하기 위해 수행하는 상호작용
    - 책임 : 객체가 협력에 참여하기 위해 수행하는 로직
    - 역할 : 협력안에서 수행하는 책임들이 모여서 역할을 구성
- 클래스와 상속은 책임과 협력이 어느 정도 자리를 잡은 후에 사용할 수 있는 구현 메커니즘일 뿐
- 어떤 협력이 필요하고 협력을 위해 어떤 역할과 책임이 필요한지를 고민해야 함

## 협력

### 협력이란?

- 어떤 객체가 다른 객체에게 무엇인가를 요청하는 것
- 보통 필요에 의해 다른 객체로 **위임하거나 서로 협력하는 상호작용**을 일컫음
- 이때 객체의 자율성이 훼손되지 않게, 즉 캡슐화하여 객체들 사이의 협력을 구성해야 함

### 협력이 설계를 위한 문맥을 결정한다

- “객체의 행동을 결정하는 것은 협력이다.”
    - Move는 **영화를 예매하기 위한 협력**에 참여함
    - 그렇기 때문에 **요금을 계산하는 행동**만 하고 (상영 관련 행동x)
    - 행동에 필요한 **fee(요금)과 discountPolicy(할인정책)이라는 상태**를 가짐
    - 따라서 협력은 객체를 설계하는데 필요한 문맥(context)을 제공한다고 볼 수 있음

## 책임

### 책임이란?

- 협력에 참여하기 위해 객체가 수행하는 행동
- 객체가 **유지해야 하는 정보**와 **수행할 수 있는 행동**에 대해 서술한 것
- ‘무엇을 알고 있는가’(knowing), ‘무엇을 할 수 있는가’(doing)로 구성
    - 하는 것 (doing)
        - 객체 생성 및 계산 수행
        - 다른 객체의 행동을 트리거
        - 대른 객체의 활동 제어 및 조절
    - 아는 것 (knowing)
        - 사적인 정보
        - 관련된 객체
        - 자신이 유도하거나 계산할 수 있는 것
- 즉, 객체가 협력에 참여하기 위해 로직을 수행하는게 책임이고
- 책임을 수행하기 위해서는 ‘아는 것’과 ‘하는 것’을 구성해야 한다
- 이를 줄여서 “객체에 책임을 할당한다”로 표헌하는 것

### 책임 할당

- 자율적인 객체를 만드는 기본적인 방법 → 정보 전문가에게 책임 할당
- 시스템이 사용자에게 제공하는 기능을 하나의 책임으로 바라
    - 영화 예매 시스템 → 상영시간, 예매가격을 아는 Screening에 책임 할당
- 더 작은 책임을 찾아내어 객체들에게 할당하는 반복적인 작업을 진행함
    - 가격 계산은 Screening → Movie로 할당

👉 즉, 필요한 메세지를 찾고 메세지에 적절한 객체를 찾는 과정을 통해 이루어짐

### 책임 주도 설계

- 책임을 찾고 책임을 수행할 적절한 객체를 찾아 책임 할당하는 방식을 “책임 주도 설계”라 함 (a.k.a 하청)

### 메세지가 객체를 결정한다

- 책임을 할당할 때 다음과 같은 순서를 따른다
    - 필요한 메세지를 먼저 식별 (예매하기)
    - 처리 할 객체를 나중에 선택 (Movie 객체)
- 위 순서를 따랐을 때의 장점
    - 객체가 최소한의 인터페이스를 가짐 (메세지가 식별될 때까지 객체의 퍼블릭 인터페이스에 추가x)
    - 객체가 추상적인 인터페이스를 가짐 (무엇(what)에 해당하는 메세지에 초점을 맞추기 때문)

👉 즉, 객체들의 인터페이스는 충분히 추상적인 동시에 최소한의 크기를 유지

### 행동이 상태를 결정한다

- 협력에 얼마나 적합한지를 결정하는 것은 ‘행동’
- 협력 관계 속에서 다른 객체에 무엇을 제공하고 무엇을 얻어야하는지 고민 (행동에 대한 고민)
    - 상태부터 결정하면 캡슐화를 저해함
- 상태는 단지 객체가 행동을 수행하기 위해 필요한 재료

👉 즉, 객체의 행동을 결정하고 행동에 필요한 상태를 결정해야 함

## 역할

### 역할이란?

- 객체가 특정한 협력 안에서 수행하는 **책임의 집합**

❓ “왜 역할이라는 개념이 필요한가? 객체만으로 충분히 협력을 설계하는 것 아닌가?”

### 유연하고 재사용 가능한 협력

- Movie → (할인 요금 계산) → AmountDiscountPolicy, PercentDiscountPolicy
- AP는 금액 할인 정책이라는 책임을, PP는 퍼센트 할인 정책이라는 책임을 갖는다 ****
- 각 책임은 ‘할인 정책’이라는 하나의 역할(책임의 집합)로 묶일 수 있다  → 추상화
- 다른 할인 정책이 추가되어도 ‘할인 정책’이라는 역할로 묶여서 협력에 참여할 수 있다 (유연함)
- 코드상으로는 추상클래스와 인터페이스가 될 수 있다

### 객체 대 역할

- 협력에 적합한 책임을 수행하는 대상이 한 종류 = 객체
- 협력에 적합한 책임을 수행하는 대상이 여러 종류 = 역할
- 세계를 바라보는 일반적인 관점으로는 **객체와 역할을 명확히 나누기는 어려움**
- 따라서 이 둘을 명확하게 나누기 보단 협력과 책임의 큰 그림으로 탐색하는 것이 중요

### 역할과 추상화

- 역할의 장점 중 하나는 추상화
- 협력 관계를 큰 그림으로 파악할 수 있음 (핵심적인 상호작용 파악)
- A정책, B정책, C정책을 계산하는 책임들 ⇒ ‘할인 정책을 수행하는 역할’ ⇒ 요금 계산이라는 협력에 적용

### 배우와 배역

- 로미오와 줄리엣 → 협력
- 로미오(배역) → 역할
- 로미오를 연기하는 배우 → 객체
- 로미오를 연기하는 행위 → 책임

👉 이는 역할을 수행하는 객체(배우)들은 다양한 역할을 가질 수 있음을 의미

👉 그렇지만 특정 협력(로미오와 줄리엣) 안에서는 하나의 역할(로미오로써)만 보여짐
