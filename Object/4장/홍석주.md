# 설계 품질과 트레이드오프

> 복습, 객체지향 설계의 핵심은 역할, 책임, 협력!
> 협력 - 애플리케이션 기능을 구현하기 위해 메시지를 주고받는 객체들 사이의 상호작용
> 책임 - 객체가 다른 객체와 협력하기 위해 수행하는 행동
> 역할 - 대체 가능한 책임의 집합

- 책임 주도 설계에서 가장 중요한 요소는 '책임'
- 책임은 객체지향 애플리케이션의 전체의 품질을 좌우함
- 객체지향 설계는 올바른 객체에게 올바른 책임을 할당하면서 `낮은 결합도`와 `높은 응집도`를 가진 구조를 창조하는 활동
- 설계는 변경을 위해 존재하고 변경에는 어떤 식으로든 비용이 발생함. 훌륭한 설계는 합리적인 비용 안에서 변경을 수용할 수 있는 구조를 만드는 것. 그러기 위해선 적히 응집도가 높고 느슨한 결합을 지향해야함
- 그러기 위해서는 객체의 상태를 바라보는 것이 아닌 객체의 행동(책임)에 초점을 맞추어야 한다.
- 상태 기반 설계는  내부 구현을 퍼블릭 인터페이스에 노출시키는 결과를 낳기 때문에 결과적으로 설계가 변경에 취약해짐

## 캡슐화

- 상태와 행동을 하나의 객체 안에 모으는 이유는 객체의 내부 구현을 외부로부터 감추기 위함.

> 구현은 나중에 변경될 가능성이 높은 어떤 것

- 캡슐화를 통해 전체 시스템에 영향을 끼치지 않도록 파급효과(ripple effect)를 조절할 수 있다.
- 그러기 위해서 변경 가능성이 높은 부분은 내부에 숨기고 외부에는 상대적으로 안정적인 부분(인터페이스)만 공개하는 것이 좋다.
- 변경의 정도에 따라 구현과 인터페이스를 분리하고 외부에서는 인터페이스만 의존하도록 관계를 조절해야함.

> 캡슐화는 우리를 좋은 코드로 안내하기 때문에 가장 중요한 제 1원리다 [Bain08]

## 응집도와 결합도

- 높은 응집도와 낮은 결합도를 가지게끔 만들어야 한다. (for 쉬운 변경)

### 응집도

- 모듈에 포함된 내부 요소들이 연관돼 있는 정도
- 모듈 내의 요소들이 하나의 목적을 위해 긴밀하게 협력한다면 응집도가 높음

### 결합도

- 의존성을 나타내는 정도
- 다른 모듈에 대해 얼마나 많은 지식을 갖고 있는지 나타내는 척도
- 다른 모듈에 대해 너무 자세한 부분까지 알고 있으면 두 모듈은 높은 결합도를 가짐
- 협력에 필요한 적절한 수준의 관계만을 유지하는 것이 관건

> 좋은 설계란 오늘의 기능을 수행하면서 내일의 변경을 수용할 수 있는 설계

## 데이터 중심 설계의 문제점

- 데이터 중심의 설계가 변경에 취약한 이유
  - 본질적으로 너무 이른 시기에 데이터에 관해 결정하도록 강요한다.
  - 협력이라는 문맥을 고려하지 않고 객체를 고립시킨 채 오퍼레이션을 결정
- 데이터 중심 설계는 절차적 프로그래밍을 따르기 때문에 단순 데이터의 집합체가 되어버리기 쉽고, 접근자와 수정자를 과도하게 추가하게 되기 때문에 캡슐화의 의미도 없어지게 된다.
- 객체지향 애플리케이션은 객체들의 공동체를 구축하는 것을 의미한다. 그렇기에 협력이라는 문맥 안에서 필요한 책음을 결정하고 이를 수행할 적절한 객체를 결정하는 것이 가장 중요.
